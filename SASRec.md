
[Paper]
https://arxiv.org/abs/1808.09781

[github / official]
https://github.com/kang205/SASRec

### 1. INTRODUCTION

#### 핵심 내용 및 배경:
Sequential 추천 시스템은 사용자의 행동에 대한 맥락을 고려하여 새로운 제품을 추천하는데 중점을 둡니다. 이러한 시스템의 핵심 목표는 사용자의 과거 행동을 분석하고 이를 바탕으로 미래의 선호도를 예측하는 것입니다. 그러나 사용자의 과거 행동 데이터가 기하급수적으로 증가함에 따라, 이러한 맥락을 정확하게 포착하는 것은 상당한 도전 과제가 되었습니다.

과거 접근 방식: MC와 RNN
이전의 Sequential 추천 시스템들은 주로 Markov Chains (MC)와 Recurrent Neural Networks (RNN)을 활용했습니다.

Markov Chains (MC): MC는 사용자의 바로 이전 행동에만 초점을 맞추어 다음 행동을 예측합니다. 이 방식은 sparsity가 높은 환경에서 효과적이지만, 데이터가 복잡하거나 dense한 경우 성능이 제한됩니다.
Recurrent Neural Networks (RNN): RNN은 숨겨진 상태(hidden states)를 통해 사용자의 모든 이전 행동을 고려하여 다음 행동을 예측합니다. 이는 더 많은 데이터와 dense한 환경에서 더 나은 성능을 보여줍니다.
새로운 접근: Self-Attentive Sequential 추천 시스템
Transformer 기반의 접근 방식인 'Self-Attention' 메커니즘은 이러한 문제를 해결하기 위한 새로운 방법을 제시합니다. Self-Attentive Sequential 추천 시스템은 각 시점에서 전체 이전 아이템을 고려하여 다음 아이템을 예측합니다. 이 방식은 다음과 같은 이점을 제공합니다:

MC와 RNN의 장점 통합: Self-Attention 메커니즘은 RNN의 연속적 특성과 MC의 직접적인 상호작용 예측 기능을 결합합니다. 이는 dense 데이터셋과 sparse 데이터셋 모두에서 효과적입니다.
성능 및 효율성: 실험을 통해, Self-Attentive Sequential 추천 시스템은 기존의 CNN/RNN 기반 모델보다 더 빠른 학습 속도와 뛰어난 예측 성능을 보여주었습니다.
분석과 시각화: 저자들은 추가적인 Ablation study를 통해 모델의 복잡성과 확장성을 분석했으며, Attention weights를 시각화하여 모델의 의사결정 과정을 명확하게 드러냈습니다.
이러한 진보는 Sequential 추천 시스템 분야에 새로운 통찰을 제공하며, 사용자의 행동 패턴과 선호도를 더 정확하고 효율적으로 예측할 수 있는 길을 열어줍니다. 이는 추천 시스템의 개인화 및 정확성을 한층 더 향상시키는 중요한 발전으로 간주됩니다.

![image](https://github.com/CVKim/PaperReview/assets/90014998/67a33d5d-b2dd-44f6-b386-435cb3d935c9)


### 2. RELATED WORK
SASRec 논문에서는 관련 작업(Related Work) 부분에서 마르코프 체인(Markov Chains, MC)과 순환 신경망(Recurrent Neural Networks, RNN)의 장단점을 분석하고, SASRec이 이들의 장점을 어떻게 통합하고 단점을 어떻게 극복했는지를 설명합니다.

### 마르코프 체인 (MC)

#### 장점:
1. **단순성**: 마르코프 체인은 상태 전이 확률을 사용하여 모델링을 수행하는 간단한 접근 방식을 제공합니다. 이는 계산적으로 효율적이며 이해하기 쉽습니다.
2. **시퀀스 의존성 모델링**: 마르코프 체인은 연속적인 상호작용 사이의 직접적인 의존성을 모델링할 수 있습니다.

#### 단점:
1. **제한된 컨텍스트**: 대부분의 마르코프 모델은 짧은 시퀀스(보통 바로 앞의 한 두 단계)에만 의존하여 예측을 수행합니다. 이는 장기적인 의존성을 포착하는 데에는 한계가 있습니다.

### 순환 신경망 (RNN)

#### 장점:
1. **장기 의존성 학습**: RNN은 이론적으로는 장기 의존성을 학습할 수 있는 구조를 가지고 있습니다.
2. **동적인 시퀀스 처리**: 가변 길이의 입력 시퀀스를 처리할 수 있으며, 시퀀스의 순차적인 특성을 잘 포착합니다.

#### 단점:
1. **경사 소실/폭발 문제**: 실제로 RNN은 경사 소실 또는 폭발 문제로 인해 실제로 장기 의존성을 효과적으로 학습하기 어렵습니다.
2. **병렬 처리의 어려움**: RNN의 순차적인 특성은 훈련 과정에서 병렬 처리를 어렵게 만듭니다.

### SASRec의 접근

#### 마르코프 체인과 RNN의 장점을 살리면서 단점을 극복:
1. **긴 시퀀스 학습**: SASRec은 자기 주의 메커니즘을 사용하여 마르코프 체인이 놓치기 쉬운 긴 시퀀스 의존성을 포착합니다.
2. **효율적인 학습과 병렬 처리**: RNN의 순차적 계산 한계를 극복하고, 데이터의 병렬 처리를 가능하게 하여 더 빠르고 효율적인 학습을 달성합니다.
3. **복잡한 패턴 인식**: 사용자의 행동 패턴을 더 복잡하고 정교하게 모델링할 수 있으며, 이를 통해 개인화된 추천의 정확도를 높입니다.
4. **장기적 의존성 및 컨텍스트 학습**: 마르코프 체인의 제한된 컨텍스트와 RNN의 장기 의존성 학습 문제를 동시에 해결하며, 사용자의 전체 행동 시퀀스를 종합적으로 고려합니다.

이러한 방식으로 SASRec은 기존 MC와 RNN 모델의 장점을 통합하면서도 그들의 주요 단점을 효과적으로 극복하는 새로운 순차적 추천 방법을 제시합니다. 이를 통해 사용자의 복잡한 상호작용 패턴을 더 정확하게 예측하고, 더 나은 추천 시스템을 구현하는 데 기여합니다.

### 3. METHODOLOGY

## SASRec의 Methodology

SASRec은 자기 주의(Self-Attention) 메커니즘을 기반으로 한 순차적 추천 시스템입니다. 이 메커니즘의 주요 수식적 구성 요소는 다음과 같습니다.

### 자기 주의 메커니즘 (Self-Attention Mechanism)
입력 시퀀스 내의 각 항목이 다른 모든 항목과 어떻게 상호작용하는지를 모델링합니다. 이는 주로 쿼리(Query), 키(Key), 밸류(Value)로 표현됩니다.

#### 쿼리, 키, 밸류 생성
사용자의 상호작용 시퀀스를 \( x = (x_1, x_2, \ldots, x_n) \)이라고 할 때, 각 상호작용 \( x_i \)에 대해 다음과 같이 표현합니다.

- 쿼리: \( Q = xW_Q \)
- 키: \( K = xW_K \)
- 밸류: \( V = xW_V \)

여기서 \( W_Q, W_K, W_V \)는 학습 가능한 가중치 행렬입니다.

#### 어텐션 스코어 계산
각 쿼리와 모든 키 사이의 관련성을 계산합니다.

- 어텐션 스코어: \( A = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right) \)

여기서 \( d_k \)는 키 벡터의 차원이며, 스케일링 팩터로 사용됩니다. Softmax 함수는 모든 어텐션 스코어의 합이 1이 되도록 보장합니다.

#### 출력값 계산
어텐션 스코어와 밸류를 결합하여 최종 출력값을 계산합니다.

- 출력: \( O = AV \)

이 출력은 각 상호작용에 대해 시퀀스 내 다른 항목들과의 관계를 인코딩한 벡터를 나타냅니다.

#### 마스킹과 포지셔널 인코딩
- 마스킹 기법을 사용하여 모델이 미래 데이터를 "보지" 않도록 합니다.
- 포지셔널 인코딩은 시퀀스 내의 각 항목의 위치 정보를 모델에 제공합니다.

![image](https://github.com/CVKim/PaperReview/assets/90014998/18a59134-c063-48e8-9070-027deee24f0c)


### Method 간략 정리
SASRec의 Methodology는 순차적 추천을 위한 자기 주의 메커니즘의 효과적인 적용을 보여줍니다. 항목 간의 복잡한 상호 의존성을 학습하고, 사용자의 최근 상호작용에 더 큰 중요성을 부여하는 전략을 통해 더 정확하고 개인화된 추천을 가능하게 합니다.


### 4. EXPERIMENTS

#### 실험 설계 및 결과 분석:
- **데이터셋의 다양성**: 연구자들은 다양한 유형의 데이터셋을 사용하여 모델을 평가합니다. 이는 다양한 환경에서의 모델의 적용성과 범용성을 시험합니다.
- **성능 메트릭스**: 정확도, 정밀도, 재현율 등 여러 성능 지표를 사용하여 SASRec의 효과를 측정합니다. 이러한 메트릭스는 모델이 실제 환경에서 얼마나 잘 작동하는지를 평가하는 데 중요합니다.
- **비교 분석**: SASRec은 기존의 순차적 추천 시스템과 비교하여 더 높은 성능을 보입니다. 이는 모델이 사용자의 복잡한 행동 패턴을 더 잘 이해하고 예측할 수 있음을 나타냅니다.

![image](https://github.com/CVKim/PaperReview/assets/90014998/a2522048-a1ec-4d6b-a33d-d04d2adeade5)
![image](https://github.com/CVKim/PaperReview/assets/90014998/1fb347f2-2bf2-4468-a333-dabfd71d5715)


이러한 상세한 분석을 통해 SASRec 논문이 순차적 추천 시스템 분야에서 어떤 새로운 관점과 해결책을 제시했는지 깊이 이해할 수 있습니다. 또한, 이 논문이 후속 연구와 실제 시스템 개발에 어떻게 영향을 미쳤는지를 평가하는 데도 도움이 됩니다.


